{%extends "index.html"%}

{%load static%}
{% block head %}
	<link href="{%static 'css/styles.css'%}" rel="stylesheet">
	<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>

<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
<script>
	function initialize(){
		var myLatlng = new google.maps.LatLng(-2.524406, -78.929772);
		var mapOptions = {
			zoom: 7,
			center: myLatlng
		}
		var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

		{% for dic in diccionario %}
			{% if dic.cantidad != 0 %}
				var marcador = new google.maps.LatLng({{dic.latitud}}, {{dic.longitud}});
				var marker = new google.maps.Marker({
					position: marcador,
					primaryColor: '#15a2cd',
					map: map,
					title: '{{dic.canton}}'
				});
				google.maps.event.addListener(marker, 'click', function(){
					var popup = new google.maps.InfoWindow();
					var note = '{{dic.cantidad}} registros en {{dic.canton}} ';
					popup.setContent(note);
					popup.open(map, this);
				})
			{% endif %}
		{% endfor %}

	}
	google.maps.event.addDomListener(window, 'load', initialize);
</script>

{% endblock %}

{%block dashboard%}
<div class="col-md-12">
	<div class="panel panel-default">
		<div class="panel-heading">
			<h4>Distribución de los pacientes por cantón</h4></div>
			<div class="panel-body">
				<section id="map-canvas" style="height:500px; width=auto"></section>
			</div>
		</div>
	</div>

	<div class="col-md-12">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h4>Porcentajes</h4></div>
				<div class="panel-body">

					{% for dic in diccionario %}
						{% if dic.cantidad != 0 %}
							<small>{{dic.canton}}</small>
							<div class="progress">
								<div class="progress-bar progress-bar-info progress-bar-striped active" role="progressbar" aria-valuenow="{{dic.porcentaje}}" aria-valuemin="0" aria-valuemax="100" style="width: {{dic.porcentaje}}%">
								</div>
								<span class="">{{dic.porcentaje}}% - {{dic.cantidad}} registros </span>
							</div>
	 					{% endif %}
					{% endfor %}
				</div>
			</div>
		</div>

		{%endblock%}
